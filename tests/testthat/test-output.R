context('print_cross')

test_that('output from print_cross matches expected output', {

    k <- cross_table(mtcars$cyl, mtcars$vs)
    pim <- "    Cell Contents
|---------------|
|     Frequency |
|       Percent |
|       Row Pct |
|       Col Pct |
|---------------|
Total Observations:  32
-------------------------------------------------------------
|              |                     vs                     |
-------------------------------------------------------------
|          cyl |            0 |            1 |    Row Total |
-------------------------------------------------------------
|            4 |            1 |           10 |           11 |
|              |        0.031 |        0.312 |              |
|              |         0.09 |         0.91 |         0.34 |
|              |         0.06 |         0.71 |              |
-------------------------------------------------------------
|            6 |            3 |            4 |            7 |
|              |        0.094 |        0.125 |              |
|              |         0.43 |         0.57 |         0.22 |
|              |         0.17 |         0.29 |              |
-------------------------------------------------------------
|            8 |           14 |            0 |           14 |
|              |        0.438 |            0 |              |
|              |            1 |            0 |         0.44 |
|              |         0.78 |            0 |              |
-------------------------------------------------------------
| Column Total |           18 |           14 |           32 |
|              |        0.563 |        0.437 |              |
-------------------------------------------------------------"

    expect_output(print_cross(k), pim)
})
